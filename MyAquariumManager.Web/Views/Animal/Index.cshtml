@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
<link rel="stylesheet" href="~/lib/datatables/datatables.min.css" asp-append-version="true" />
<script src="~/lib/datatables/datatables.min.js" asp-append-version="true"></script>

@{
    ViewData["Title"] = "Animais";
}

<div class="container mt-3 d-flex justify-content-center">
    <h3>Animais Cadastrados</h3>
</div>

<div class="container mt-4"></div>

<table id="table-animais" class="display" style="width: 100%">
    <thead>
        <tr>
            <th class="d-none">Id</th>
            <th>Nome</th>
            <th>Nome Científico</th>
            <th>Espécie</th>
            <th>Data Aquisição</th>
            <th>Local da Aquisição</th>
            <th>Tipo de Água</th>
            <th>Origem</th>
        </tr>
    </thead>
</table>

<div class="container mt-3"></div>

<div class="container d-flex justify-content-end">
    <a asp-action="Cadastro" class="btn btn-outline-dark d-flex justify-content-center align-items-center">Cadastrar Animal<i class="fa fa-square-plus fa-2x"></i></a>
</div>

<script>
    $(document).ready(function() {
        carregarTableAnimais();
    });

    const tipoDeAguaMap = {
        1: "Água Doce",
        2: "Água Salgada",
        3: "Salobra"
    }

    function carregarTableAnimais() {
        return $('#table-animais').DataTable({
            scrollY: 400,
            pageLength: 25,
            responsive: true,
            processing: true,
            serverSide: true,
            ordering: true,
            order: [[0, 'desc']],
            searching: false,
            paging: true,
            ajax: {
                url: "/carregar-table-animais",
                type: "GET",
                datatype: "json"
            },
            columns: [
                { data: "id" }, 
                { data: "nome" },
                { data: "nomeCientifico" },
                { data: "especie" },
                { data: "dataAquisicao",
                  render: function (data, type, row) {
                    if (data) {
                        var date = new Date(data);
                        var dia = ('0' + date.getDate()).slice(-2);
                        var mes = ('0' + (date.getMonth() + 1)).slice(-2);
                        var ano = date.getFullYear();

                        return dia + '/' + mes + '/' + ano;
                    }

                    return '';
                  }
                },
                { data: "localAquisicao" },
                { data: "tipoDeAgua",
                  render: function (data, type, row) {
                      return tipoDeAguaMap[data] || 'Não Informado';
                  }
                },
                { data: "origem" }
            ],
            columnDefs: [
                {
                    targets: 0,
                    visible: false,
                    searchable: false
                }
            ]
        });
    }
</script>

@{
}

