@using MyAquariumManager.Core.Enums
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Cadastrar Animal";
}

<div class="container d-flex justify-content-center">
    <h4>Informe os dados para cadastrar um novo animal</h4>
</div>

<div class="container mt-3"></div>

<div class="container">
    <form id="form-cadastro-animal">
        <div class="row">
            <div class="col-sm-12 col-md-6 mb-3">
                <label for="nome" class="form-label">Nome: </label>
                <input type="text" id="nome" name="Nome" class="form-control" maxlength="200" required />
            </div>
            <div class="col-sm-12 col-md-6 mb-3">
                <label for="nomeCientifico" class="form-label">Nome Científico: </label>
                <input type="text" id="nomeCientifico" name="Nome Científico" class="form-control" maxlength="200" />
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12 col-md-2 mb-3">
                <label for="dataAquisicao" class="form-label">Data Aquisição:</label> 
                <input type="date" id="dataAquisicao" name="Data da Aquisição" class="form-control" />
            </div>
            <div class="col-sm-12 col-md-4 mb-3">
                <label for="localAquisicao" class="form-label">Local Aquisição: </label>
                <input type="text" id="localAquisicao" name="Local da Aquisição" class="form-control" maxlength="100" />
            </div>
            <div class="col-sm-12 col-md-6 mb-3">
                <label for="especie" class="form-label">Espécie: </label>
                <input type="text" id="especie" name="Espécie" class="form-control" maxlength="100" />
            </div>
        </div>
        
        <div class="row">
            <div class="col-sm-12 col-md-4 mb-3">
                <label for="origem" class="form-label">Origem: </label>
                <input type="text" id="origem" name="Origem" class="form-control" maxlength="100" />
            </div>
            <div class="col-sm-12 col-md-4 mb-3">
                <label for="comportamento" class="form-label">Comportamento: </label>
                <input type="text" id="comportamento" name="Comportamento" class="form-control" maxlength="100" />
            </div>
            <div class="col-sm-12 col-md-4 mb-3">
                <label for="faixaPH" class="form-label">Faixa do PH: </label>
                <input type="text" id="faixaPH" name="Faixa do PH" class="form-control" maxlength="100" />
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12 col-md-2 mb-3">
                <label for="cardumeiro" class="form-label">Cardumeiro?</label>
                <input type="checkbox" id="cardumeiro" name="É cardumeiro?" class="form-control form-check-input" />
            </div>
            <div class="col-sm-12 col-md-2 mb-3">
                <label for="quantidadeMinima" class="form-label">Quantidade Mínima</label>
                <input type="number" id="quantidadeMinima" name="Quantidade Mínima" class="form-control" required />
            </div>
            <div class="col-sm-12 col-md-2 mb-3">
                <label for="litragemMinima" class="form-label">Litragem Mínima</label>
                <input type="number" id="litragemMinima" name="Litragem Mínima" class="form-control" required />
            </div>
            <div class="col-sm-12 col-md-3 mb-3">
                <label for="tipoDeAlimentacao" class="form-label">Tipo de Alimentação</label>
                <select id="tipoDeAlimentacao" name="Tipo de Alimentação" class="form-select" required>
                    <option value="selecione">-- Selecione --</option>
                    @{
                        string tipoDeAlimentacao = string.Empty;

                        foreach (var tipo in Enum.GetValues(typeof(TipoDeAlimentacao)))
                        {
                            switch (tipo)
                            {
                                case TipoDeAlimentacao.Onivoro:
                                    tipoDeAlimentacao = "Onívoro";
                                    break;
                                case TipoDeAlimentacao.Detritivoro:
                                    tipoDeAlimentacao = "Detritívoro";
                                    break;
                                case TipoDeAlimentacao.Herbivoro:
                                    tipoDeAlimentacao = "Herbívoro";
                                    break;
                                case TipoDeAlimentacao.Carnivoro:
                                    tipoDeAlimentacao = "Carnívoro";
                                    break;
                            }

                            <option value="@tipo">@tipoDeAlimentacao</option>
                        }
                    }
                </select>
            </div>
            <div class="col-sm-12 col-md-3 mb-3">
                <label for="tipoDeAgua" class="form-label">Tipo de Água</label>
                <select id="tipoDeAgua" name="Tipo de Água" class="form-select" required>
                    <option value="selecione">-- Selecione --</option>
                    @{
                        foreach (var tipo in Enum.GetValues(typeof(TipoDeAgua)))
                        {
                            <option value="@tipo">@tipo</option>
                        }
                    }
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 mb-3">
                <label for="faixaDeTamanho" class="form-label">Faixa de Tamanho: </label>
                <input type="text" id="faixaDeTamanho" name="Faixa de Tamanho" class="form-control" maxlength="100" />
            </div>
            <div class="col-sm-12 col-md-6 mb-3">
                <label for="faixaDeTemperatura" class="form-label">Faixa de Temperatura: </label>
                <input type="text" id="faixaDeTemperatura" name="Faixa de Temperatura" class="form-control" maxlength="100" />
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-12 mb-3">
                <label for="informacoesAdicionais" class="form-label">Informações Adicionais: </label>
                <textarea id="informacoesAdicionais" rows="4" cols="50" style="resize: none;" maxlength="800" class="form-control"></textarea>
            </div>
        </div>
        <div class="row">
            <div class="container d-flex justify-content-end">
                <a asp-action="Index" class="btn btn-outline-dark d-flex justify-content-center align-items-center mx-3">Voltar</a>
                <button type="button" onclick="cadastrarAnimal()" class="btn btn-dark d-flex justify-content-center align-items-center">Cadastrar Animal</button>
            </div>
        </div>
    </form>
</div>

<script>
    function addAllEventListener() {
        let campos = document.querySelectorAll('input, textarea, select');
        campos.forEach(campo => {
            campo.addEventListener('input', function() {
                if (this.classList.contains('is-invalid')) {
                    this.classList.remove('is-invalid');
                }
            });
        });
    }
    
    addAllEventListener();

    function cadastrarAnimal() {
        if (!validarFormulario()) {
            return;
        }

        let criarAnimalDto = obterDadosFormulario();

    }

    function validarFormulario() { 
        let formularioValido = true;
        
        let camposObrigatorios = document.querySelectorAll('input[required], textarea[required], select[required]');
        
        camposObrigatorios.forEach(campo => {
            campo.classList.remove('is-invalid');
        });
        
        camposObrigatorios.forEach(campo => {
            if (campo.value.trim() === '') {
                toastr.warning(`O campo ${campo.name} é obrigatório.`);
                campo.classList.add('is-invalid');
                formularioValido = false;
            }
        });

        return formularioValido;
    }

    function obterDadosFormulario() {
        let animal = {
            Nome: document.getElementById('nome').value.trim(),
            NomeCientifico: document.getElementById('nomeCientifico').value.trim(),
            DataAquisicao: document.getElementById('dataAquisicao').value,
            LocalAquisicao: document.getElementById('localAquisicao').value.trim(),
            Especie: document.getElementById('especie').value.trim(),
            Origem: document.getElementById('origem').value.trim(),
            Comportamento: document.getElementById('comportamento').value.trim(),
            FaixaPH: document.getElementById('faixaPH').value.trim(),
            Cardumeiro: document.getElementById('cardumeiro').checked,
            QuantidadeMinima: parseInt(document.getElementById('quantidadeMinima').value) || 0,
            LitragemMinima: parseInt(document.getElementById('litragemMinima').value) || 0,
            TipoDeAlimentacao: document.getElementById('tipoDeAlimentacao').value,
            TipoDeAgua: document.getElementById('tipoDeAgua').value,
            FaixaDeTamanho: document.getElementById('faixaDeTamanho').value.trim(),
            FaixaDeTemperatura: document.getElementById('faixaDeTemperatura').value.trim(),
            InformacoesAdicionais: document.getElementById('informacoesAdicionais').value.trim()
        };

        return animal;
    }

</script>


